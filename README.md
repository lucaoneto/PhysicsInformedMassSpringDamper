# PhisicsInformedMassSpringDamper

In this repository, you can find the code of the toy example proposed in the paper "A Review on Full-, Zero-, and Partial-Knowledge based Predictive Models for Industrial Applications" (Section 4 - Illustrative Example).

## Underlying physics
The toy example analyzes a mass-spring-damper system with no external force applied. 

![4](https://github.com/lucaoneto/PhisicsInformedMassSpringDamper/assets/158032647/119b7700-74e8-4225-94cb-168d1f228c49)

We consider the case of the mass initially positioned at a specific point $u_0$, that is left free to evolve autonomously over time.

In the simplest case, a mass-spring-damper system can be described by a second-order differential equation
$$m \frac{d^2 u(t)}{d t^2} + \mu \frac{d u(t)}{d t} + k_0 u(t) = 0 \quad \text{(Eq1)}$$
  where $m$ is the mass (measured in $[kg]$), $\mu$ is the damping coefficient (measured in $[\frac{Ns}{m}]$), and $k_0$ is the spring constant.

For scenarios where the linear approximation of the proportional relationship between force and displacement of the spring is insufficient, a more complex representation can be considered
$$m \frac{d^2 u(t)}{d t^2} + \mu \frac{d u(t)}{d t} + k_1 u(t) + k_2 u^3(t) = 0 \quad \text{(Eq2)}$$
where $k_1$ and $k_2$ are the spring linear and nonlinear coefficients (measured in $[\frac{N}{m}]$ and $[\frac{N}{m^3}]$ respectively)

## Introduction
We assume to 
Given a mass-spring-damper system, we assume to have the capability to measure the displacement $u(t)$ of the mass at various moments in time $t$ in the range $[0,t_m]$.

**Our scope is to predict the massâ€™s position $(u(t))$ at any given time in the range $[0, t_f]$ ($t_f \> t_m$)** 

We will compare three methods to achive this target: 
- FKPM
- ZKPM
- PKPM

The measures are stored in the dataset $\mathcal{D}_n = \{ (t_1,u(t_1)), \cdots, (t_n,u(t_n)) \}$. 
For the scope of this examples, data are synthetically generated. 

We analyzed different conditions of:
- data-generating model ($\text{(Eq1)}$ or $\text{(Eq1)}$) 
- quality of the measures (presence of noise)

Overall, four scenarios are studied:
- Surrogation scenario with no noise: Dataset $\mathcal{D}^{1, 0}_n$ generated by $\text{(Eq1)}$
- Surrogation scenario with noise: Dataset $\mathcal{D}^{1, \sigma}_n$ generated by $\text{(Eq1)}$ currupted by noise
- Modeling scenario with no noise: Dataset $\mathcal{D}^{2, 0}_n$ generated by $\text{(Eq2)}$
- Modeling scenario with noise: Dataset $\mathcal{D}^{2, \sigma}_n$ generated by $\text{(Eq2)}$ currupted by noise

In presence of noise, experiemens are repeated 30 times to obtain robust results.
Even if the noise is randomly generated, the experiment reproducibility is guaranteed by the control of the random seed.

Our procedure is the following:
- Data generation
- The four scenarios approached with FKPM
- The four scenarios approached with ZKPM
- The four scenarios approached with PKPM
- Results analysis

Accordingly, the code is organized in 5 folders:
- Data Generation
- FKPM
- ZKPM
- PKPM
- Results

## Data Generation
In Data Generation we stored the script DatGen.m that produces the datasets. 
The code solves the equations $\text{(Eq1)}$ and $\text{(Eq2)}$ and extract 22 samples for each scenario:
- Dataset $\mathcal{D}^{1, 0}_n$ from $\text{(Eq1)}$
- Dataset $\mathcal{D}^{1, \sigma}_n$ from $\text{(Eq1)}$ and adding random noise
- Dataset $\mathcal{D}^{2, 0}_n$ from $\text{(Eq2)}$
- Dataset $\mathcal{D}^{2, \sigma}_n$ from $\text{(Eq2)}$ and adding random noise

The whole process is repeated 30 times, to average the random effect of the noise.
Data are saved in 30 files, named DatGen_SeedN.mat.

## FKPM
In FKPM we put the script FKPM.m that models the full-knowledge approach.
This model is built to solve the $\text{(Eq1)}$. 
We assume to not know the parameters $k_0$, $\mu$, and $u_0$, that are grid searched in the range $[10^{-1}, 10^{3}]$. 

